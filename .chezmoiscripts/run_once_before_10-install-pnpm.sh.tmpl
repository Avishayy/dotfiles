#!/bin/bash

set -eufo pipefail

echo "Installing pnpm via nvm + corepack"

if [ -z "${NVM_DIR:-}" ]; then
  export NVM_DIR="$HOME/.nvm"
fi

if [ -s "$NVM_DIR/nvm.sh" ]; then
  # shellcheck disable=SC1090
  . "$NVM_DIR/nvm.sh"
else
  echo "nvm not found in $NVM_DIR" >&2
  exit 1
fi

echo "Installing latest Node.js LTS with nvm"
nvm install --lts
nvm use --lts

echo "Enabling corepack and activating pnpm"
corepack enable
corepack prepare pnpm@latest --activate

echo "pnpm installed via corepack"
